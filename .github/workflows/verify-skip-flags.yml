name: Verify SKIP_TESTS_AWS/AZURE flags

on:
  pull_request:
    branches: [ main ]
    paths:
      - '.github/workflows/*.yml'

jobs:
  verify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Check workflows for skip flags
        run: |
          WORKFLOWS=".github/workflows/fastsafetensors-benchmark.yml .github/workflows/integration-e2e.yml .github/workflows/ci.yml .github/workflows/integration-tests.yml"
          for wf in $WORKFLOWS; do
            if ! grep -q "SKIP_TESTS_AWS.*true" "$wf" || ! grep -q "SKIP_TESTS_AZURE.*true" "$wf"; then
              echo "❌ Missing skip flags in $wf"
              exit 1
            fi
          done
          echo "✅ All required workflows have SKIP_TESTS_AWS and SKIP_TESTS_AZURE set to true"
